#### Object变化侦测

* 大体流程描述

  数据也就是Data在被Observer处理后变成有getter和setter的数据，getter可以在用户获取数据时感知到，setter可以在用户改变数据时感知到。当外界(某个视图、方法)需要用到某个数据时，也就是这个外界依赖某个数据，此时会创建一个Watcher实例，通过它去依赖那个数据（通过它去获得那个数据的值，通过它来通知自己更新视图）。我们为每一个数据都创建一个依赖数组，里面存储的是对这个数据依赖的所有watcher，当这个数据改变时可以遍历这个数据的依赖数组，通知每一个依赖(watcher)。这个过程是在创建watcher的时候收集依赖的。当外界创建watcher的时候，将watcher这个实例对象挂载在window.target下，然后去获取这个数据，因为数据已经被observer处理过了，所以会触发getter，触发getter后就可以知道谁依赖了这个数据，将window.target中的依赖者watcher存入每个数据都会有的依赖数组中，存入后将window.target设为undefined进行释放，方便其他依赖者的使用。此时每个数据的依赖数组中都将有关的依赖者存好了。这时如果用户修改数据，就会触发已被observer处理后的setter，可以在这个里面对依赖数组中的每个依赖进行调用(通知)，让他们所对应的外界(视图、方法)进行更新。

* 整个流程总结

  1. Data通过observer转换成getter/setter的形式来追踪变化
  2. 当外界通过watcher读数据时，会触发getter从而将watcher添加到对应数据的依赖数组中
  3. 当数据变化时，会触发setter，从而想Dep中的依赖(即watcher)发送通知
  4. watcher接收到通知后，会向外界发送通知，变化通知到外界后可能会触发视图更新，也有可能触发用户的某个回调函数等

* 流程图